(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{373:function(t,e,n){var a=n(374);"string"===typeof a&&(a=[[t.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(79)(a,i);a.locals&&(t.exports=a.locals)},374:function(t,e,n){(t.exports=n(78)(!1)).push([t.i,".musicList {\n  width: 1000px;\n  height: calc(100vh - 95px);\n  margin: 20px auto;\n  background: #fff9e9;\n}\n.musicList ul {\n  height: 60vh;\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  justify-content: space-around;\n}\n.musicList ul li {\n  position: relative;\n}\n.musicList ul li .musicBox {\n  width: 150px;\n  height: 150px;\n  margin: 10px;\n  border-radius: 100%;\n  overflow: hidden;\n  box-shadow: 0 0 3px #666666;\n  cursor: pointer;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.musicList ul li .musicBox img {\n  width: 100%;\n}\n.musicList ul li .musicBox .musicLoading {\n  position: absolute;\n  z-index: 99;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.musicList ul li .musicBox .rotateGo {\n  animation: myfirst 10s infinite;\n  animation-timing-function: linear;\n  filter: blur(2px);\n}\n.musicList ul li .musicInfo {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n.musicList ul li .musicInfo p {\n  width: 150px;\n  height: 24px;\n  line-height: 24px;\n  display: inline-block;\n  text-align: center;\n  color: #fff9e9;\n  background: rgba(84, 120, 240, 0.65);\n  border-radius: 3px;\n  padding: 2px 3px;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  margin-bottom: 2px;\n  font-size: 13px;\n}\n.musicList .audiobox,\n.musicList .searchBox {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n.musicList .audiobox .hotList,\n.musicList .searchBox .hotList {\n  margin: 10px 0;\n}\n.musicList .audiobox .hotList span,\n.musicList .searchBox .hotList span {\n  display: inline-block;\n  margin: 0 5px;\n  height: 24px;\n  line-height: 24px;\n  text-align: center;\n  padding: 0 5px;\n  background: #007d78;\n  border-radius: 3px;\n  color: #ffffff;\n  font-size: 12px;\n  cursor: pointer;\n}\n.musicList .audiobox .iconBtn,\n.musicList .searchBox .iconBtn {\n  position: absolute;\n  font-size: 16px;\n  transition: all 0.2s;\n}\n.musicList .audiobox .iconBtn:hover,\n.musicList .searchBox .iconBtn:hover {\n  font-size: 18px;\n  cursor: pointer;\n}\n.musicList .loadingBox {\n  width: 100vw;\n  height: 100vh;\n  background: rgba(255, 255, 255, 0.6);\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 999;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n@keyframes myfirst {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n",""])},421:function(t,e,n){"use strict";n.r(e);var a=n(97),i=n.n(a),s=n(408),r=n(98),c=n(5),o=n(6),l=n(8),u=n(7),d=n(9),m=n(0),h=n.n(m),p=n(184),x=n(417),f=n(99),g=n.n(f),v=(n(373),n(375)),y=function(t){var e=t.prevMusic;return h.a.createElement(p.a,{name:"fast backward",className:"iconBtn",style:{left:"50px"},onClick:e})},b=function(t){var e=t.nextMusic;return h.a.createElement(p.a,{name:"fast forward",className:"iconBtn",style:{right:"50px"},onClick:e})},k=function(){return h.a.createElement(p.a,{disabled:!0,name:"play",style:{position:"absolute",transform:"translateY(10px)",fontSize:"36px",color:"#007d78"}})},S=function(t){var e=t.list,n=t.hotClick;return h.a.createElement("div",{className:"hotList"},e.map(function(t,e){return h.a.createElement("span",{key:e,onClick:n},t)}))},w=function(t){var e=t.text,n=t.change,a=t.search;return h.a.createElement(x.a,{value:e,onChange:n,icon:h.a.createElement(p.a,{name:"search",inverted:!0,circular:!0,link:!0,onClick:a}),placeholder:"Search...",style:{width:"300px"}})},E=function(t){function e(t){var n;return Object(c.a)(this,e),(n=Object(l.a)(this,Object(u.a)(e).call(this,t))).audioFn=function(t){var e=n.audioEle;if(32===t.keyCode&&n.state.musicUrl)if(e.paused){e.play();var a=sessionStorage.getItem("musicIndex");n.setState({currentIndex:Number(a)})}else e.pause(),n.setState({currentIndex:-1});else 13===t.keyCode&&n.handleSearch()},n.handleChange=function(t){n.setState({text:t.target.value})},n.handleSearch=function(){var t=n.state.text,e=n.audioEle;n.state.musicUrl&&(e.pause(),n.setState({currentIndex:-1})),""===t.trim()?alert("\u8bf7\u8f93\u5165\u641c\u7d22\u7684\u97f3\u4e50\u540d\u79f0"):n.getMusicList(t).then(function(){n.setState({text:""})})},n.playhotMusic=function(t){var e=t.target.innerText;n.getMusicList(e)},n.getMusicList=Object(r.a)(i.a.mark(function t(){var e,a,r,c=arguments;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=c.length>0&&void 0!==c[0]?c[0]:"\u559c\u6b22",n.setState({loading:!0}),t.next=4,g()({url:"https://api.apiopen.top/searchMusic",method:"GET",params:{name:e}});case 4:200===(a=t.sent).status?0!==a.data.result.length&&(r=Object(s.a)(new Set([].concat(Object(s.a)(n.state.hotSearch),[e]))).slice(-5),n.setState({dataSorce:a.data.result,hotSearch:r},function(){localStorage.setItem("hotMusic",JSON.stringify(r))})):console.log(a.data.message),setTimeout(function(){n.setState({loading:!1})},1e3);case 7:case"end":return t.stop()}},t,this)})),n.prevClick=function(){if(!(n.state.currentIndex>0))return!1;n.setState(function(t){return{currentIndex:t.currentIndex-1}},function(){var t=n.state.currentIndex,e=n.state.dataSorce[t].songid;n.getCurrentMusic(e)})},n.nextClick=function(){if(!(n.state.currentIndex<n.state.dataSorce.length-1))return!1;n.setState(function(t){return{currentIndex:t.currentIndex+1}},function(){var t=n.state.currentIndex,e=n.state.dataSorce[t].songid;n.getCurrentMusic(e)})},n.state={currentIndex:-1,dataSorce:[],musicUrl:"",text:"",hotSearch:[],loading:!1},n}return Object(d.a)(e,t),Object(o.a)(e,[{key:"componentDidMount",value:function(){this.getMusicList();var t=localStorage.getItem("hotMusic");t&&this.setState({hotSearch:JSON.parse(t)}),window.addEventListener("keydown",this.audioFn,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.audioFn,!1)}},{key:"handleClick",value:function(t,e){var n=this;console.log(t.lrc),sessionStorage.setItem("musicIndex",e),this.setState({currentIndex:e},function(){n.getCurrentMusic(t.songid)})}},{key:"getCurrentMusic",value:function(){var t=Object(r.a)(i.a.mark(function t(e){var n,a=this;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(this.state.currentIndex),t.next=3,g()({url:"https://api.imjad.cn/cloudmusic/",method:"get",params:{type:"song",id:e,br:128e3}});case 3:200===(n=t.sent).status?(console.log(n.data),n.data.data&&this.setState({musicUrl:n.data.data[0].url},function(){console.log(a.state.musicUrl)})):console.log(n.statusText);case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return h.a.createElement("div",{className:"musicList"},this.state.loading&&h.a.createElement("div",{className:"loadingBox"},h.a.createElement(v,{name:"line-scale",color:"red"})),h.a.createElement("div",{className:"searchBox"},h.a.createElement(w,{text:this.state.text,change:this.handleChange,search:this.handleSearch}),h.a.createElement(S,{list:this.state.hotSearch,hotClick:this.playhotMusic})),h.a.createElement("ul",null,this.state.dataSorce.map(function(e,n){return h.a.createElement("li",{key:n,onClick:function(){return t.handleClick(e,n)}},h.a.createElement("div",{className:"musicBox"},h.a.createElement("img",{src:e.pic,alt:e.title,className:t.state.currentIndex===n?"rotateGo":""}),t.state.currentIndex===n?h.a.createElement("div",{className:"musicLoading"},h.a.createElement(v,{name:"line-scale-pulse-out",color:"orange"})):h.a.createElement(k,null)),h.a.createElement("div",{className:"musicInfo"},h.a.createElement("p",null,"\u4f5c\u66f2\uff1a",e.author),h.a.createElement("p",null,e.title)))})),h.a.createElement("div",{style:{marginTop:"30px"}},this.state.musicUrl&&h.a.createElement("div",{className:"audiobox",style:{position:"relative",width:"500px",margin:"0 auto"}},0!==this.state.currentIndex&&h.a.createElement(y,{prevMusic:this.prevClick}),h.a.createElement("audio",{src:this.state.musicUrl,preload:"auto",autoPlay:!0,controls:!0,loop:!0,ref:function(e){return t.audioEle=e}}),this.state.currentIndex!==this.state.dataSorce.length-1&&h.a.createElement(b,{nextMusic:this.nextClick}))))}}]),e}(m.Component);e.default=E}}]);