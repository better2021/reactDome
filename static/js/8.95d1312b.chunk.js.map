{"version":3,"sources":["webpack:///./src/pages/music/index.less?2cf2","pages/music/index.less","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","pages/music/index.jsx"],"names":["content","__webpack_require__","module","i","options","hmr","transform","insertInto","undefined","locals","exports","push","_toConsumableArray","arr","Array","isArray","arr2","length","_arrayWithoutHoles","iter","Symbol","iterator","Object","prototype","toString","call","from","_iterableToArray","TypeError","_nonIterableSpread","IconExampleDisabled","react_default","a","createElement","Icon","disabled","name","style","position","fontSize","color","HotList","_ref","list","hotClick","className","map","item","index","key","onClick","InputExampleIconElement","_ref2","text","change","search","Input","value","onChange","icon","inverted","circular","link","placeholder","width","Music","props","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","audioFn","event","audioEle","keyCode","state","musicUrl","paused","play","sessionStorage","getItem","setState","currentIndex","Number","pause","handleSearch","handleChange","target","title","trim","alert","getMusicList","then","playhotMusic","innerText","asyncToGenerator","regenerator_default","mark","_callee","res","_args","arguments","wrap","_context","prev","next","axios","url","method","params","sent","status","data","result","Set","hotSearch","concat","slice","dataSorce","localStorage","setItem","JSON","stringify","console","log","message","stop","hotMusic","parse","window","addEventListener","removeEventListener","getCurrentMusic","songid","songId","type","id","br","_this2","statusText","_this3","music_InputExampleIconElement","music_HotList","handleClick","src","pic","alt","music_IconExampleDisabled","preload","autoPlay","controls","loop","ref","c","Component"],"mappings":"6EACA,IAAAA,EAAcC,EAAQ,KAEtB,kBAAAD,MAAA,EAA4CE,EAAAC,EAASH,EAAA,MAOrD,IAAAI,EAAA,CAAeC,KAAA,EAEfC,eAPAA,EAQAC,gBAAAC,GAEaP,EAAQ,IAARA,CAA8DD,EAAAI,GAE3EJ,EAAAS,SAAAP,EAAAQ,QAAAV,EAAAS,8BCjBAP,EAAAQ,QAA2BT,EAAQ,IAARA,EAA0D,IAKrFU,KAAA,CAAcT,EAAAC,EAAS,6vCAA2vC,oECFnwC,SAAAS,EAAAC,GACf,OCJe,SAAAA,GACf,GAAAC,MAAAC,QAAAF,GAAA,CACA,QAAAV,EAAA,EAAAa,EAAA,IAAAF,MAAAD,EAAAI,QAAiDd,EAAAU,EAAAI,OAAgBd,IACjEa,EAAAb,GAAAU,EAAAV,GAGA,OAAAa,GDFSE,CAAiBL,IEJX,SAAAM,GACf,GAAAC,OAAAC,YAAAC,OAAAH,IAAA,uBAAAG,OAAAC,UAAAC,SAAAC,KAAAN,GAAA,OAAAL,MAAAY,KAAAP,GFGmCQ,CAAed,IGJnC,WACf,UAAAe,UAAA,mDHG2DC,0GIErDC,UAAsB,kBAAMC,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,UAAQ,EAACC,KAAK,OAAOC,MAAO,CAAEC,SAAU,WAAYhC,UAAW,mBAAoBiC,SAAU,OAAQC,MAAO,eAC9IC,EAAU,SAAAC,GAAA,IAAGC,EAAHD,EAAGC,KAAMC,EAATF,EAASE,SAAT,OACdb,EAAAC,EAAAC,cAAA,OAAKY,UAAU,WACbF,EAAKG,IAAI,SAACC,EAAMC,GACd,OAAQjB,EAAAC,EAAAC,cAAA,QAAMgB,IAAKD,EAAOE,QAASN,GAAWG,OAI9CI,EAA0B,SAAAC,GAAA,IAAGC,EAAHD,EAAGC,KAAMC,EAATF,EAASE,OAAQC,EAAjBH,EAAiBG,OAAjB,OAC9BxB,EAAAC,EAAAC,cAACuB,EAAA,EAAD,CAAOC,MAAOJ,EAAMK,SAAUJ,EAAQK,KAAM5B,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAME,KAAK,SAASwB,UAAQ,EAACC,UAAQ,EAACC,MAAI,EAACZ,QAASK,IAAYQ,YAAY,YAAY1B,MAAO,CAAE2B,MAAO,YAGhJC,cACJ,SAAAA,EAAYC,GAAO,IAAAC,EAAA,OAAA7C,OAAA8C,EAAA,EAAA9C,CAAA+C,KAAAJ,IACjBE,EAAA7C,OAAAgD,EAAA,EAAAhD,CAAA+C,KAAA/C,OAAAiD,EAAA,EAAAjD,CAAA2C,GAAAxC,KAAA4C,KAAMH,KAyBRM,QAAU,SAACC,GACT,IAAMC,EAAWP,EAAKO,SACtB,GAAsB,KAAlBD,EAAME,SAAkBR,EAAKS,MAAMC,SACrC,GAAIH,EAASI,OAAQ,CACnBJ,EAASK,OACT,IAAM/B,EAAQgC,eAAeC,QAAQ,cACrCd,EAAKe,SAAS,CACZC,aAAcC,OAAOpC,UAGvB0B,EAASW,QACTlB,EAAKe,SAAS,CACZC,cAAe,SAGQ,KAAlBV,EAAME,SACfR,EAAKmB,gBA1CUnB,EAuDnBoB,aAAe,SAACd,GAEdN,EAAKe,SAAS,CACZ7B,KAAMoB,EAAMe,OAAO/B,SA1DJU,EA+DnBmB,aAAe,WAEb,IAAMG,EAAQtB,EAAKS,MAAMvB,KACnBqB,EAAWP,EAAKO,SAClBP,EAAKS,MAAMC,WACbH,EAASW,QACTlB,EAAKe,SAAS,CACZC,cAAe,KAIE,KAAjBM,EAAMC,OACRC,MAAM,gEAENxB,EAAKyB,aAAaH,GAAOI,KAAK,WAC5B1B,EAAKe,SAAS,CACZ7B,KAAM,QA/EKc,EAsFnB2B,aAAe,SAACrB,GAEd,IAAMgB,EAAQhB,EAAMe,OAAOO,UAC3B5B,EAAKyB,aAAaH,IAzFDtB,EA6FnByB,aA7FmBtE,OAAA0E,EAAA,EAAA1E,CAAA2E,EAAAjE,EAAAkE,KA6FJ,SAAAC,IAAA,IAAAV,EAAAW,EAAAvF,EAAAwF,EAAAC,UAAA,OAAAL,EAAAjE,EAAAuE,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAOjB,EAAPY,EAAApF,OAAA,QAAAT,IAAA6F,EAAA,GAAAA,EAAA,GAAe,eAAfG,EAAAE,KAAA,EACKC,IAAM,CACtBC,IAAK,sCACLC,OAAQ,MACRC,OAAQ,CAAE1E,KAAMqD,KAJL,OAOM,OANbW,EADOI,EAAAO,MAOLC,OAEyB,IAA3BZ,EAAIa,KAAKC,OAAOjG,SACdJ,EAAMD,EAAI,IAAIuG,IAAJvG,EAAYuD,EAAKS,MAAMwC,WAAvBC,OAAA,CAAkC5B,MAAS6B,OAAO,GAChEnD,EAAKe,SAAS,CACZqC,UAAWnB,EAAIa,KAAKC,OACpBE,UAAWvG,GACV,WACD2G,aAAaC,QAAQ,WAAYC,KAAKC,UAAU9G,OAIpD+G,QAAQC,IAAIzB,EAAIa,KAAKa,SAnBV,wBAAAtB,EAAAuB,SAAA5B,EAAA9B,SA3FbF,EAAKS,MAAQ,CACXO,cAAe,EACfoC,UAAW,GACX1C,SAAU,GACVxB,KAAM,GACN+D,UAAW,IAPIjD,mFAYjBE,KAAKuB,eACL,IAAMoC,EAAWR,aAAavC,QAAQ,YAClC+C,GACF3D,KAAKa,SAAS,CACZkC,UAAWM,KAAKO,MAAMD,KAG1BE,OAAOC,iBAAiB,UAAW9D,KAAKG,SAAS,kDAIjD0D,OAAOE,oBAAoB,UAAW/D,KAAKG,SAAS,uCAuB1CzB,EAAMC,GAEhBgC,eAAeyC,QAAQ,aAAczE,GACrCqB,KAAKa,SAAS,CACZC,aAAcnC,IAEhBqB,KAAKgE,gBAAgBtF,EAAKuF,wFAiENC,gGACF5B,IAAM,CACtBC,IAAK,mCACLC,OAAQ,MACRC,OAAQ,CACN0B,KAAM,OACNC,GAAIF,EACJG,GAAI,gBAGW,OATbtC,UASEY,QACNY,QAAQC,IAAIzB,EAAIa,MACZb,EAAIa,KAAKA,MACX5C,KAAKa,SAAS,CACZL,SAAUuB,EAAIa,KAAKA,KAAK,GAAGL,KAC1B,WACDgB,QAAQC,IAAIc,EAAK/D,MAAMC,aAI3B+C,QAAQC,IAAIzB,EAAIwC,gJAIX,IAAAC,EAAAxE,KACP,OAAQtC,EAAAC,EAAAC,cAAA,OAAKY,UAAU,aACrBd,EAAAC,EAAAC,cAAA,OAAKY,UAAU,aACbd,EAAAC,EAAAC,cAAC6G,EAAD,CAAyBzF,KAAMgB,KAAKO,MAAMvB,KAAMC,OAAQe,KAAKkB,aAAchC,OAAQc,KAAKiB,eACxFvD,EAAAC,EAAAC,cAAC8G,EAAD,CAASpG,KAAM0B,KAAKO,MAAMwC,UAAWxE,SAAUyB,KAAKyB,gBAEtD/D,EAAAC,EAAAC,cAAA,UAEIoC,KAAKO,MAAM2C,UAAUzE,IAAI,SAACC,EAAMC,GAC9B,OACEjB,EAAAC,EAAAC,cAAA,MAAIY,UAAWgG,EAAKjE,MAAMO,eAAiBnC,EAAQ,WAAa,GAAIC,IAAKD,EAAOE,QAAS,kBAAM2F,EAAKG,YAAYjG,EAAMC,KACpHjB,EAAAC,EAAAC,cAAA,OAAKY,UAAU,YAAWd,EAAAC,EAAAC,cAAA,OAAKgH,IAAKlG,EAAKmG,IAAKC,IAAKpG,EAAK0C,QAAS1D,EAAAC,EAAAC,cAACmH,EAAD,WAM3ErH,EAAAC,EAAAC,cAAA,WAEIoC,KAAKO,MAAMC,UAAY9C,EAAAC,EAAAC,cAAA,OAAKY,UAAU,YAAWd,EAAAC,EAAAC,cAAA,SAAOgH,IAAK5E,KAAKO,MAAMC,SAAUwE,QAAQ,OAAOC,UAAQ,EAACC,UAAQ,EAACC,MAAI,EAACC,IAAK,SAAAC,GAAC,OAAIb,EAAKnE,SAAWgF,eAjKxIC,aAwKL1F","file":"static/js/8.95d1312b.chunk.js","sourcesContent":["\nvar content = require(\"!!../../../node_modules/css-loader/index.js??ref--6-oneOf-7-1!../../../node_modules/less-loader/dist/cjs.js!./index.less\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js??ref--6-oneOf-7-1!../../../node_modules/less-loader/dist/cjs.js!./index.less\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js??ref--6-oneOf-7-1!../../../node_modules/less-loader/dist/cjs.js!./index.less\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".musicList {\\n  width: 1000px;\\n  height: 90vh;\\n  margin: 20px auto;\\n}\\n.musicList ul {\\n  height: 60vh;\\n  display: flex;\\n  flex-wrap: wrap;\\n  align-items: center;\\n  justify-content: space-around;\\n}\\n.musicList ul li {\\n  width: 150px;\\n  height: 150px;\\n  margin: 10px;\\n  border-radius: 100%;\\n  overflow: hidden;\\n  box-shadow: 0 0 3px #666666;\\n}\\n.musicList ul li .musicBox {\\n  cursor: pointer;\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n}\\n.musicList ul li .musicBox img {\\n  width: 100%;\\n}\\n.musicList ul li.rotateGo {\\n  animation: myfirst 10s infinite;\\n  animation-timing-function: linear;\\n}\\n.musicList .audiobox,\\n.musicList .searchBox {\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n}\\n.musicList .audiobox .hotList,\\n.musicList .searchBox .hotList {\\n  margin: 10px 0;\\n}\\n.musicList .audiobox .hotList span,\\n.musicList .searchBox .hotList span {\\n  display: inline-block;\\n  margin: 0 5px;\\n  height: 24px;\\n  line-height: 24px;\\n  text-align: center;\\n  padding: 0 5px;\\n  background: #007d78;\\n  border-radius: 3px;\\n  color: #ffffff;\\n  font-size: 12px;\\n  cursor: pointer;\\n}\\n@keyframes myfirst {\\n  0% {\\n    transform: rotate(0deg);\\n  }\\n  100% {\\n    transform: rotate(360deg);\\n  }\\n}\\n\", \"\"]);\n\n// exports\n","import arrayWithoutHoles from \"./arrayWithoutHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport nonIterableSpread from \"./nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}","export default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}","export default function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}","\r\nimport React, { Component } from 'react'\r\nimport { Icon, Input } from 'semantic-ui-react'\r\nimport axios from 'axios'\r\nimport './index.less'\r\n\r\nconst IconExampleDisabled = () => <Icon disabled name='play' style={{ position: 'absolute', transform: 'translateY(10px)', fontSize: '36px', color: '#007d78' }} />\r\nconst HotList = ({ list, hotClick }) => (\r\n  <div className=\"hotList\">{\r\n    list.map((item, index) => {\r\n      return (<span key={index} onClick={hotClick}>{item}</span>)\r\n    })\r\n  }</div>\r\n)\r\nconst InputExampleIconElement = ({ text, change, search }) => (\r\n  <Input value={text} onChange={change} icon={<Icon name='search' inverted circular link onClick={search} />} placeholder='Search...' style={{ width: '300px' }} />\r\n)\r\n\r\nclass Music extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      currentIndex: -1,\r\n      dataSorce: [],\r\n      musicUrl: '',\r\n      text: '',\r\n      hotSearch: []\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getMusicList() //获取音乐列表\r\n    const hotMusic = localStorage.getItem('hotMusic')\r\n    if (hotMusic) {\r\n      this.setState({\r\n        hotSearch: JSON.parse(hotMusic)\r\n      })\r\n    }\r\n    window.addEventListener('keydown', this.audioFn, false)\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('keydown', this.audioFn, false)\r\n  }\r\n\r\n  audioFn = (event) => {\r\n    const audioEle = this.audioEle\r\n    if (event.keyCode === 32 && this.state.musicUrl) {\r\n      if (audioEle.paused) {\r\n        audioEle.play()\r\n        const index = sessionStorage.getItem('musicIndex')\r\n        this.setState({\r\n          currentIndex: Number(index)\r\n        })\r\n      } else {\r\n        audioEle.pause()\r\n        this.setState({\r\n          currentIndex: -1\r\n        })\r\n      }\r\n    } else if (event.keyCode === 13) {\r\n      this.handleSearch()\r\n    }\r\n  }\r\n\r\n  handleClick(item, index) {\r\n    //console.log(item, index)\r\n    sessionStorage.setItem('musicIndex', index)\r\n    this.setState({\r\n      currentIndex: index\r\n    })\r\n    this.getCurrentMusic(item.songid)\r\n  }\r\n\r\n  handleChange = (event) => {\r\n    //console.log(event.target.value)\r\n    this.setState({\r\n      text: event.target.value\r\n    })\r\n  }\r\n\r\n  //搜索\r\n  handleSearch = () => {\r\n    //console.log(this.state.text)\r\n    const title = this.state.text;\r\n    const audioEle = this.audioEle\r\n    if (this.state.musicUrl) {\r\n      audioEle.pause() //点击搜索后暂停音乐\r\n      this.setState({\r\n        currentIndex: -1\r\n      })\r\n    }\r\n\r\n    if (title.trim() === '') {\r\n      alert('请输入搜索的音乐名称')\r\n    } else {\r\n      this.getMusicList(title).then(() => {\r\n        this.setState({\r\n          text: ''\r\n        })\r\n      })\r\n    }\r\n  }\r\n\r\n  //播放热门音乐\r\n  playhotMusic = (event) => {\r\n    //console.log(event.target.innerText)\r\n    const title = event.target.innerText;\r\n    this.getMusicList(title)\r\n  }\r\n\r\n  //获取音乐列表\r\n  getMusicList = async (title = '喜欢') => {\r\n    const res = await axios({\r\n      url: 'https://api.apiopen.top/searchMusic',\r\n      method: 'GET',\r\n      params: { name: title },\r\n    })\r\n\r\n    if (res.status === 200) {\r\n      //console.log(res.data);\r\n      if (res.data.result.length !== 0) {\r\n        let arr = [...new Set([...this.state.hotSearch, title])].slice(-5)\r\n        this.setState({\r\n          dataSorce: res.data.result,\r\n          hotSearch: arr\r\n        }, () => {\r\n          localStorage.setItem('hotMusic', JSON.stringify(arr))\r\n        })\r\n      }\r\n    } else {\r\n      console.log(res.data.message)\r\n    }\r\n  }\r\n\r\n  //获取单个音乐文件url链接地址\r\n  async getCurrentMusic(songId) {\r\n    const res = await axios({\r\n      url: 'https://api.imjad.cn/cloudmusic/',\r\n      method: 'get',\r\n      params: {\r\n        type: 'song',\r\n        id: songId,\r\n        br: 128000\r\n      }\r\n    })\r\n    if (res.status === 200) {\r\n      console.log(res.data)\r\n      if (res.data.data) {\r\n        this.setState({\r\n          musicUrl: res.data.data[0].url\r\n        }, () => {\r\n          console.log(this.state.musicUrl)\r\n        })\r\n      }\r\n    } else {\r\n      console.log(res.statusText)\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (<div className=\"musicList\">\r\n      <div className=\"searchBox\">\r\n        <InputExampleIconElement text={this.state.text} change={this.handleChange} search={this.handleSearch} />\r\n        <HotList list={this.state.hotSearch} hotClick={this.playhotMusic} />\r\n      </div>\r\n      <ul>\r\n        {\r\n          this.state.dataSorce.map((item, index) => {\r\n            return (\r\n              <li className={this.state.currentIndex === index ? 'rotateGo' : \"\"} key={index} onClick={() => this.handleClick(item, index)}>\r\n                <div className=\"musicBox\"><img src={item.pic} alt={item.title} /><IconExampleDisabled /></div>\r\n              </li>\r\n            )\r\n          })\r\n        }\r\n      </ul>\r\n      <div>\r\n        {\r\n          this.state.musicUrl && <div className=\"audiobox\"><audio src={this.state.musicUrl} preload=\"auto\" autoPlay controls loop ref={c => this.audioEle = c}></audio></div>\r\n        }\r\n      </div>\r\n    </div>)\r\n  }\r\n}\r\n\r\nexport default Music\r\n"],"sourceRoot":""}